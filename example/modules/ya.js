// ----------------------------------------------------------------------------------------------------------------- //

var $querystring = require('querystring');

// ----------------------------------------------------------------------------------------------------------------- //

var config = global.config || {};

// ----------------------------------------------------------------------------------------------------------------- //

var Result = require('../../lib/result.js');
var util = require('../../lib/util.js');

// ----------------------------------------------------------------------------------------------------------------- //

var ya = {};

// ----------------------------------------------------------------------------------------------------------------- //

ya.auth = function(promise, context) {
    var host = config.blackbox.host;
    var path = config.blackbox.path + '?' + $querystring.stringify({
        method: 'sessionid',
        userip: context.headers['x-real-ip'],
        sessionid: context.cookies['Session_id'],
        host: config.blackbox.domain,
        format: 'json'
    });

    util.http.get( {
        host: host,
        path: path,
        port: 80
    }, function(result) {
        promise.resolve(result);
    } );
};

// ----------------------------------------------------------------------------------------------------------------- //

module.exports = ya;

// ----------------------------------------------------------------------------------------------------------------- //

